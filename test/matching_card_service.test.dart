import 'package:flutter_test/flutter_test.dart';
import 'package:http/http.dart' as http;
import 'package:mockito/annotations.dart';
import 'package:mockito/mockito.dart';
import 'package:of_card_match/models/team.dart';
import 'package:of_card_match/services/matching_card_service.dart';
import 'dart:io';

import 'matching_card_service.test.mocks.dart';

// Generate a MockClient using the Mockito package.
// Create new instances of this class in each test.
@GenerateMocks([http.Client])
void main() {
  group('fetchMatchList', () {
    test('returns a list of Matches if the http call completes successfully',
        () async {
      final client = MockClient();

      // Use Mockito to return a successful response when it calls the
      // provided http.Client.
      when(client.get(Uri.parse(
              'https://scores-api.onefootball.com/v1/en/competitions/12/players/top?size=50')))
          .thenAnswer((_) async => http.Response(
                  '[{"id":134,"name":"Lionel Messi","firstName":"Lionel","lastName":"Messi","nickName":"Messi","position":"Forward","number":10,"birthDate":"1987-06-24","age":36,"weight":"72","height":"170","country":"Argentina","followers":3253798,"imageSrc":"https://images.onefootball.com/players/180/134.jpg","thumbnailImageSrc":"https://images.onefootball.com/players/180/134.jpg?fallback=false","heroImageSrc":"https://images.onefootball.com/players/hero/571/134.webp","nationalTeam":{"idInternal":55,"name":"Argentina","colors":{"shirtColorHome":"FFFFFF","shirtColorAway":"","crestMainColor":"","mainColor":"1CACE3"},"logoUrls":[{"size":"56x56","url":"https://images.onefootball.com/icons/teams/56/55.png"},{"size":"164x164","url":"https://images.onefootball.com/icons/teams/164/55.png"}]}},{"id":823,"name":"Cristiano Ronaldo","firstName":"Cristiano","lastName":"Ronaldo","nickName":"Ronaldo","position":"Forward","number":7,"birthDate":"1985-02-05","age":38,"weight":"83","height":"187","country":"Portugal","followers":2904279,"imageSrc":"https://images.onefootball.com/players/180/823.jpg","thumbnailImageSrc":"https://images.onefootball.com/players/180/823.jpg?fallback=false","heroImageSrc":"https://images.onefootball.com/players/hero/571/823.webp","nationalTeam":{"idInternal":43,"name":"Portugal","colors":{"shirtColorHome":"C81414","shirtColorAway":"","crestMainColor":"FF0000","mainColor":"C81414"},"logoUrls":[{"size":"56x56","url":"https://images.onefootball.com/icons/teams/56/43.png"},{"size":"164x164","url":"https://images.onefootball.com/icons/teams/164/43.png"}]}},{"id":19515,"name":"Neymar","firstName":"Neymar","lastName":"","nickName":"Neymar","position":"Forward","number":10,"birthDate":"1992-02-05","age":31,"weight":"68","height":"175","country":"Brazil","followers":1939120,"imageSrc":"https://images.onefootball.com/players/180/19515.jpg","thumbnailImageSrc":"https://images.onefootball.com/players/180/19515.jpg?fallback=false","nationalTeam":{"idInternal":79,"name":"Brazil","colors":{"shirtColorHome":"FFFF00","shirtColorAway":"","crestMainColor":"","mainColor":"FDE117"},"logoUrls":[{"size":"56x56","url":"https://images.onefootball.com/icons/teams/56/79.png"},{"size":"164x164","url":"https://images.onefootball.com/icons/teams/164/79.png"}]}},{"id":172496,"name":"Kylian Mbappé","firstName":"Kylian","lastName":"Mbappé","nickName":"Mbappé","position":"Forward","number":7,"birthDate":"1998-12-20","age":24,"weight":"75","height":"178","country":"France","followers":1661371,"imageSrc":"https://images.onefootball.com/players/180/172496.jpg","thumbnailImageSrc":"https://images.onefootball.com/players/180/172496.jpg?fallback=false","heroImageSrc":"https://images.onefootball.com/players/hero/571/172496.webp","nationalTeam":{"idInternal":45,"name":"France","colors":{"shirtColorHome":"05044E","shirtColorAway":"","crestMainColor":"002294","mainColor":"143262"},"logoUrls":[{"size":"56x56","url":"https://images.onefootball.com/icons/teams/56/45.png"},{"size":"164x164","url":"https://images.onefootball.com/icons/teams/164/45.png"}]}},{"id":1992,"name":"Robert Lewandowski","firstName":"Robert","lastName":"Lewandowski","nickName":"Lewandowski","position":"Forward","number":9,"birthDate":"1988-08-21","age":35,"weight":"81","height":"185","country":"Poland","followers":801161,"imageSrc":"https://images.onefootball.com/players/180/1992.jpg","thumbnailImageSrc":"https://images.onefootball.com/players/180/1992.jpg?fallback=false","heroImageSrc":"https://images.onefootball.com/players/hero/571/1992.webp","nationalTeam":{"idInternal":103,"name":"Poland","colors":{"shirtColorHome":"FFFFFF","shirtColorAway":"","crestMainColor":"DC133B","mainColor":"FFFFFF"},"logoUrls":[{"size":"56x56","url":"https://images.onefootball.com/icons/teams/56/103.png"},{"size":"164x164","url":"https://images.onefootball.com/icons/teams/164/103.png"}]}},{"id":172006,"name":"Marcus Rashford","firstName":"Marcus","lastName":"Rashford","nickName":"Rashford","position":"Forward","number":10,"birthDate":"1997-10-31","age":25,"weight":"70","height":"180","country":"England","followers":380489,"imageSrc":"https://images.onefootball.com/players/180/172006.jpg","thumbnailImageSrc":"https://images.onefootball.com/players/180/172006.jpg?fallback=false","heroImageSrc":"https://images.onefootball.com/players/hero/571/172006.webp","nationalTeam":{"idInternal":61,"name":"England","colors":{"shirtColorHome":"FFFFFF","shirtColorAway":"","crestMainColor":"FFFFFF","mainColor":"FFFFFF"},"logoUrls":[{"size":"56x56","url":"https://images.onefootball.com/icons/teams/56/61.png"},{"size":"164x164","url":"https://images.onefootball.com/icons/teams/164/61.png"}]}},{"id":1814,"name":"Luka Modrić","firstName":"Luka","lastName":"Modrić","nickName":"Modrić","position":"Midfielder","number":10,"birthDate":"1985-09-09","age":38,"weight":"66","height":"172","country":"Croatia","followers":375000,"imageSrc":"https://images.onefootball.com/players/180/1814.jpg","thumbnailImageSrc":"https://images.onefootball.com/players/180/1814.jpg?fallback=false","heroImageSrc":"https://images.onefootball.com/players/hero/571/1814.webp","nationalTeam":{"idInternal":99,"name":"Croatia","colors":{"shirtColorHome":"FFFFFF","shirtColorAway":"","crestMainColor":"FF0000","mainColor":"FC0D1B"},"logoUrls":[{"size":"56x56","url":"https://images.onefootball.com/icons/teams/56/99.png"},{"size":"164x164","url":"https://images.onefootball.com/icons/teams/164/99.png"}]}},{"id":387991,"name":"Gavi","firstName":"","lastName":"","nickName":"Gavi","position":"Midfielder","number":6,"birthDate":"2004-08-05","age":19,"weight":"70","height":"173","country":"Spain","followers":361908,"imageSrc":"https://images.onefootball.com/players/180/387991.jpg","thumbnailImageSrc":"https://images.onefootball.com/players/180/387991.jpg?fallback=false","nationalTeam":{"idInternal":34,"name":"Spain","colors":{"shirtColorHome":"CC0000","shirtColorAway":"","crestMainColor":"C50A1E","mainColor":"FC0D1B"},"logoUrls":[{"size":"56x56","url":"https://images.onefootball.com/icons/teams/56/34.png"},{"size":"164x164","url":"https://images.onefootball.com/icons/teams/164/34.png"}]}},{"id":3148,"name":"Harry Kane","firstName":"Harry","lastName":"Kane","nickName":"Kane","position":"Forward","number":9,"birthDate":"1993-07-28","age":30,"weight":"86","height":"188","country":"England","followers":354762,"imageSrc":"https://images.onefootball.com/players/180/3148.jpg","thumbnailImageSrc":"https://images.onefootball.com/players/180/3148.jpg?fallback=false","nationalTeam":{"idInternal":61,"name":"England","colors":{"shirtColorHome":"FFFFFF","shirtColorAway":"","crestMainColor":"FFFFFF","mainColor":"FFFFFF"},"logoUrls":[{"size":"56x56","url":"https://images.onefootball.com/icons/teams/56/61.png"},{"size":"164x164","url":"https://images.onefootball.com/icons/teams/164/61.png"}]}},{"id":343087,"name":"Jude Bellingham","firstName":"Jude","lastName":"Bellingham","nickName":"Bellingham","position":"Midfielder","number":5,"birthDate":"2003-06-29","age":20,"weight":"75","height":"186","country":"England","followers":317660,"imageSrc":"https://images.onefootball.com/players/180/343087.jpg","thumbnailImageSrc":"https://images.onefootball.com/players/180/343087.jpg?fallback=false","heroImageSrc":"https://images.onefootball.com/players/hero/571/343087.webp","nationalTeam":{"idInternal":61,"name":"England","colors":{"shirtColorHome":"FFFFFF","shirtColorAway":"","crestMainColor":"FFFFFF","mainColor":"FFFFFF"},"logoUrls":[{"size":"56x56","url":"https://images.onefootball.com/icons/teams/56/61.png"},{"size":"164x164","url":"https://images.onefootball.com/icons/teams/164/61.png"}]}}]',
                  200,
                  headers: {
                    HttpHeaders.contentTypeHeader:
                        'application/json; charset=utf-8',
                  }));
      final service = MatchingCardService(client);

      expect(await service.getMatchingCards(), isA<List<MatchCard>>());
    });
  });
}
